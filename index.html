<!DOCTYPE html>
<html>
<head>
    <title>Streamtape Browser Client</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; }
        .section { border: 1px solid #ddd; padding: 15px; margin: 10px 0; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Streamtape Browser Client</h1>

    <div class="section">
        <h2>API Credentials</h2>
        <input type="text" id="login" placeholder="API Login">
        <input type="password" id="key" placeholder="API Key">
    </div>

    <div class="section">
        <h2>File Browser</h2>
        <button onclick="listFiles()">List All Files</button>
        <button onclick="listFolders()">List All Folders</button>
        <div id="output"></div>
    </div>

    <div class="section">
        <h2>API Response</h2>
        <pre id="result"></pre>
    </div>

    <script>
        // Client-side API handler
        async function streamtapeAPI(endpoint, params = {}) {
            const login = document.getElementById('login').value;
            const key = document.getElementById('key').value;
            
            const url = new URL(`https://api.streamtape.com/${endpoint}`);
            url.searchParams.append('login', login);
            url.searchParams.append('key', key);
            
            Object.entries(params).forEach(([key, value]) => {
                url.searchParams.append(key, value);
            });

            try {
                const response = await fetch(url);
                const data = await response.json();
                displayResult(data);
                return data;
            } catch (error) {
                displayResult({ error: error.message });
            }
        }

        // Display formatted results
        function displayResult(data) {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = JSON.stringify(data, null, 2);
        }

        // File listing with IDs
        async function listFiles() {
            const data = await streamtapeAPI('file/listfolder', { folder: '' });
            if (data?.result?.files) {
                const output = document.getElementById('output');
                output.innerHTML = data.result.files.map(file => `
                    <div>📄 ${file.name} <em>(ID: ${file.id})</em></div>
                `).join('');
            }
        }

        // Folder listing with IDs
        async function listFolders() {
            const data = await streamtapeAPI('file/listfolder', { folder: '' });
            if (data?.result?.folders) {
                const output = document.getElementById('output');
                output.innerHTML = data.result.folders.map(folder => `
                    <div>📁 ${folder.name} <em>(ID: ${folder.id})</em></div>
                `).join('');
            }
        }
    </script>
</body>
</html>
